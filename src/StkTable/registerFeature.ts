import { ref } from 'vue';
import { useAreaSelection, useAreaSelectionFnName } from './features';

type OnDemandFeature = {
    [useAreaSelectionFnName]: typeof useAreaSelection<any>;
};

export const ON_DEMAND_FEATURE: OnDemandFeature = {
    [useAreaSelectionFnName]: (() => {
        console.warn('useAreaSelection is not registered');
        return {
            isSelecting: ref(false),
            onMD: () => {},
            getClass: () => [],
            get: () => ({ rows: [], cols: [], range: null }),
            clear: () => {},
            copy: () => '',
        };
    }) as typeof useAreaSelection<any>,
};

type Feature = OnDemandFeature[keyof OnDemandFeature];

export function registerFeature(feature: Feature | Feature[]) {
    const features = Array.isArray(feature) ? feature : [feature];
    features.forEach(f => {
        (ON_DEMAND_FEATURE as any)[f.name] = f as any;
    });
}
